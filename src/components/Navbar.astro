---
import { Globe, TrendingUp, BarChart3, Camera } from 'lucide-react';

const navItems = [
  { name: 'Home', href: '/', icon: Globe },
  { name: 'Captured Interests', href: '/photography', icon: Camera },
  { name: 'Cost Metrics', href: '/infrastructure', icon: BarChart3 },
  { name: 'Quotes', href: '/trends', icon: TrendingUp },
];

const pathname = new URL(Astro.request.url).pathname;
// Helper to match active links even with trailing slashes
const isCurrentPath = (href: string) => 
  pathname === href || (href !== '/' && pathname.startsWith(href));
---

<nav class="fixed top-8 left-1/2 -translate-x-1/2 z-[100] w-fit pointer-events-auto">
  <div class="flex items-center gap-1 p-2 rounded-full border border-white/10 bg-[#050810]/40 backdrop-blur-2xl shadow-[0_8px_32px_rgba(0,0,0,0.8)]">
    {navItems.map((item) => {
      const Icon = item.icon;
      const active = isCurrentPath(item.href);
      
      return (
        <a 
          href={item.href}
          class:list={[
            "relative flex items-center gap-2.5 px-5 py-2.5 rounded-full transition-all duration-500 group overflow-hidden",
            active ? "text-blue-400" : "text-white/40 hover:text-white"
          ]}
        >
          {/* Active Background Glow */}
          {active && (
            <div class="absolute inset-0 bg-blue-500/10 border border-blue-500/20 shadow-[inset_0_0_12px_rgba(59,130,246,0.2)]"></div>
          )}

          <Icon size={16} strokeWidth={active ? 2.5 : 2} class:list={[
            "transition-transform duration-500 group-hover:scale-110",
            active ? "drop-shadow-[0_0_8px_rgba(59,130,246,0.8)]" : ""
          ]} />
          
          <span class="text-[11px] font-mono font-bold uppercase tracking-[0.2em] relative z-10">
            {item.name}
          </span>

          {/* Animated Interaction Underline */}
          <div class:list={[
            "absolute bottom-0 left-1/2 -translate-x-1/2 h-[2px] bg-blue-500 transition-all duration-500",
            active ? "w-1/3 opacity-100 shadow-[0_0_10px_#3b82f6]" : "w-0 opacity-0 group-hover:w-1/4 group-hover:opacity-50"
          ]}></div>
        </a>
      );
    })}
  </div>
</nav>

<style is:global>
  /* Subtle float-in animation on load */
  nav {
    animation: navSlideIn 1s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }

  @keyframes navSlideIn {
    from { 
      opacity: 0; 
      transform: translate(-50%, -30px) scale(0.95); 
      backdrop-filter: blur(0px);
    }
    to { 
      opacity: 1; 
      transform: translate(-50%, 0) scale(1); 
      backdrop-filter: blur(24px);
    }
  }

  /* Optional: Text glow for active links */
  .text-blue-400 {
    text-shadow: 0 0 10px rgba(59, 130, 246, 0.4);
  }
</style>