---
import Layout from '../layouts/Layout.astro';
import EarthCanvas from '../components/EarthCanvas.tsx';
import LeetCodeCard from '../components/LeetCodeCard.tsx';
import ProjectGrid from '../components/ProjectGrid.tsx';
import LinkedInCard from '../components/LinkedInCard.tsx';
import CertificationGrid from '../components/CertificationGrid.tsx';
import Navbar from '../components/Navbar.astro';
import { Mail, Activity, Cpu, Database, Cloud, Code2 } from 'lucide-react';

export const prerender = false;
---

<Layout title="Abhiram | Portfolio">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,100..900&display=swap" rel="stylesheet">

  <div class="fixed inset-0 z-0 bg-[#000000] overflow-hidden">
    <div id="stars" class="absolute inset-0"></div>
    <div id="stars2" class="absolute inset-0"></div>
    <div id="stars3" class="absolute inset-0"></div>
    
    <div class="absolute inset-0 z-10 bg-[url('/noise.svg')] opacity-[0.03] mix-blend-overlay pointer-events-none"></div>
    <EarthCanvas client:only="react" />
    <div class="absolute inset-0 z-20 bg-gradient-to-b from-black/20 via-black/40 to-[#000000]"></div>
  </div>

  <Navbar />

  <main class="relative z-10 w-full antialiased font-inter">
    
    <section id="home" class="h-screen w-full flex items-center justify-end px-[8vw] py-20">
      <div class="text-right animate-fade-in w-full max-w-7xl">
        <h1 class="hero-name text-[clamp(3.5rem,10vw,8rem)] leading-tight select-none">
          Abhiram
        </h1>
        
        <p class="hero-tagline text-[clamp(1rem,2.5vw,1.6rem)] text-white/80 mt-1 pr-1">
          Architecting the Digital Cosmos
        </p>
        
        <div class="mt-12 border-t border-white/10 pt-10 inline-block">
          <p class="text-[clamp(1rem,2.2vw,1.4rem)] text-white font-semibold tracking-tight leading-none uppercase">
            Purdue University
          </p>
          <p class="text-blue-400/60 text-[clamp(0.7rem,0.9vw,0.8rem)] font-bold uppercase tracking-[0.5em] mt-5">
            M.S. Student in <span class="text-white/80">Computer Science</span>
          </p>
        </div>
      </div>
    </section>

    <section class="w-full py-10 px-[5vw] flex flex-wrap items-center justify-center gap-10 -mt-20 mb-20">
      <div class="flex items-center gap-3 px-5 py-2.5 rounded-full border border-white/5 bg-white/[0.02] backdrop-blur-2xl">
        <div class="h-1.5 w-1.5 rounded-full bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.6)]"></div>
        <p class="text-[10px] font-bold uppercase tracking-[0.2em] text-white/40">
          Visitors: <span id="visitor-count" class="text-blue-500 font-extrabold ml-1">000000</span>
        </p>
      </div>

      <div class="flex items-center gap-3 px-5 py-2.5 rounded-full border border-white/5 bg-white/[0.02] backdrop-blur-2xl">
        <Activity size={10} id="metrics-icon" class="text-white/20" />
        <p class="text-[10px] font-bold uppercase tracking-[0.2em] text-white/40">
          Uplink: <span id="uplink-status" class="ml-1 text-yellow-500 font-extrabold tracking-widest">SYNCING</span>
        </p>
      </div>
    </section>

    <div class="w-full bg-white/[0.01] border-y border-white/5 py-8 backdrop-blur-sm overflow-hidden whitespace-nowrap mb-20 relative">
        <div class="absolute inset-y-0 left-0 w-32 bg-gradient-to-r from-black to-transparent z-10"></div>
        <div class="absolute inset-y-0 right-0 w-32 bg-gradient-to-l from-black to-transparent z-10"></div>
        
        <div class="inline-block animate-marquee">
            <div class="inline-flex items-center gap-16 px-8 text-[11px] font-bold uppercase tracking-[0.3em] text-white/30">
                <span class="flex items-center gap-2"><Code2 size={13} class="text-blue-500"/> React</span>
                <span class="text-white/10">//</span>
                <span class="flex items-center gap-2"><Cpu size={13} class="text-blue-500"/> TypeScript</span>
                <span class="text-white/10">//</span>
                <span class="flex items-center gap-2"><Cloud size={13} class="text-blue-500"/> AWS Cloud</span>
                <span class="text-white/10">//</span>
                <span class="flex items-center gap-2"><Database size={13} class="text-blue-500"/> DynamoDB</span>
                <span class="text-white/10">//</span>
                <span class="flex items-center gap-2"><Code2 size={13} class="text-blue-500"/> Astro</span>
                <span class="text-white/10">//</span>
                <span class="flex items-center gap-2"><Cpu size={13} class="text-blue-500"/> Node.js</span>
                <span class="text-white/10">//</span>
                <span class="flex items-center gap-2"><Database size={13} class="text-blue-500"/> Python</span>
            </div>
        </div>
    </div>

    <section id="leetcode" class="min-h-screen w-full flex flex-col items-center justify-center px-[5vw] py-32">
      <div class="max-w-5xl w-full">
        <h2 class="section-title">Statistical Performance</h2>
        <div class="backdrop-blur-3xl rounded-[2.5rem] border border-white/5 bg-white/[0.01] p-2">
           <LeetCodeCard client:only="react" /> 
        </div>
      </div>
    </section>

    <section id="builds" class="min-h-screen w-full py-32 px-[5vw]">
      <div class="max-w-7xl mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-end mb-24 gap-12">
          <div class="max-w-xl text-left">
            <h3 class="section-subtitle">System Architecture</h3>
            <p class="text-white/20 text-[10px] font-bold uppercase tracking-[0.2em]">Deployment Pipeline Verified.</p>
          </div>
          <h2 class="text-[clamp(3rem,8vw,6rem)] font-extrabold uppercase tracking-tight text-white leading-none">Core <span class="text-blue-500">Builds</span></h2>
        </div>
        <ProjectGrid client:load />
      </div>
    </section>

    <section id="network" class="min-h-screen w-full py-32 px-[5vw] flex items-center justify-center">
      <LinkedInCard client:load />
    </section>

    <section id="certifications" class="min-h-screen w-full py-32 px-[5vw] flex items-center justify-center">
      <div class="max-w-7xl w-full">
        <h2 class="section-title">Verified Infrastructure</h2>
        <CertificationGrid client:load />
      </div>
    </section>

    <section id="contact" class="min-h-[80vh] w-full py-32 px-[5vw] flex items-center justify-center">
      <div class="max-w-3xl w-full text-center">
        <div class="group p-16 md:p-24 rounded-[3rem] border border-white/5 bg-white/[0.01] backdrop-blur-3xl transition-all">
          <h2 class="text-[clamp(2rem,5vw,4rem)] font-extrabold text-white uppercase tracking-tight mb-12 leading-none">Contact <span class="text-blue-500">Me</span></h2>
          <a href="mailto:mulpm01@purdue.edu" class="inline-flex flex-col items-center gap-6 px-12 py-10 rounded-[2rem] bg-white/5 border border-white/5 hover:border-blue-500/20 transition-all duration-500">
            <Mail size={28} class="text-blue-500" />
            <span class="text-[clamp(0.9rem,2.5vw,1.4rem)] font-bold text-white tracking-widest break-all">mulpm01@purdue.edu</span>
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<script>
  async function syncDashboard() {
    try {
      const res = await fetch('/api/telemetry');
      const data = await res.json();
      const statusEl = document.getElementById('uplink-status');
      if (statusEl && (data.aws?.status === "ONLINE" || data.status === "ONLINE")) {
          statusEl.innerText = "ACTIVE";
          statusEl.className = "ml-1 text-blue-400 font-extrabold tracking-widest animate-pulse";
      }
      const vEl = document.getElementById('visitor-count');
      const vRes = await fetch('/api/visitor-count');
      const vData = await vRes.json();
      if (vEl && vData.count) vEl.innerText = vData.count.toString().padStart(6, '0');
    } catch (e) { 
      console.error('üõ∞Ô∏è Sync Failed');
    }
  }
  window.addEventListener('load', syncDashboard);
</script>

<style is:global>
  @reference "../styles/global.css"; 

  :global(html) {
    scroll-behavior: smooth;
    background-color: #000000;
    font-family: 'Inter', sans-serif;
    -webkit-font-smoothing: antialiased;
  }

  ::-webkit-scrollbar { display: none; }

  .hero-name {
    font-family: 'Segoe Script', 'Segoe UI Script', cursive;
    background: linear-gradient(to bottom, #ffffff 60%, #3b82f6 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    filter: drop-shadow(0 10px 30px rgba(59, 130, 246, 0.15));
  }

  .hero-tagline {
    font-family: 'Segoe Script', 'Segoe UI Script', cursive;
    text-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
  }

  .section-title { @apply text-white/30 font-bold tracking-[0.6em] text-center text-[9px] uppercase mb-20; }
  .section-subtitle { @apply font-bold text-blue-500 uppercase tracking-[0.4em] mb-4 text-[9px]; }

  #stars, #stars2, #stars3 { position: absolute; inset: 0; background: transparent; }
  #stars { width: 1px; height: 1px; box-shadow: 1452px 1451px #FFF, 246px 1452px #FFF, 1234px 12px #FFF, 456px 890px #FFF; animation: animStar 50s linear infinite; }
  #stars2 { width: 2px; height: 2px; box-shadow: 123px 456px #FFF, 789px 123px #FFF; animation: animStar 100s linear infinite; }
  #stars3 { width: 3px; height: 3px; box-shadow: 500px 500px #FFF, 1200px 800px #FFF; animation: animStar 150s linear infinite; }

  @keyframes animStar { from { transform: translateY(0px); } to { transform: translateY(-2000px); } }
  .animate-marquee { display: inline-block; animation: marquee 40s linear infinite; }
  @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
  .animate-fade-in { animation: fadeIn 1.2s forwards; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
</style>