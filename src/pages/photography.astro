---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import PhotoGallery from '../components/PhotoGallery'; 
import EarthCanvas from '../components/EarthCanvas';
// Import the dynamic utility instead of JSON
import { getCapturedInterests } from '../lib/aws';
import { Activity } from 'lucide-react';

// Fetch live from S3
const photos = await getCapturedInterests();
---

<Layout title="Photography | Captured Interests">
  <div class="fixed inset-0 z-0 bg-[#050810]">
    <div class="absolute inset-0 z-10 bg-[url('/noise.svg')] opacity-[0.05] mix-blend-overlay pointer-events-none"></div>
    <EarthCanvas client:only="react" />
    <div class="absolute inset-0 z-20 bg-gradient-to-b from-[#050810]/10 via-transparent to-[#050810]/80"></div>
  </div>

  <Navbar />

  <main class="relative z-30 w-full min-h-screen pt-32 pb-40 px-[6vw] overflow-visible">
    <div class="max-w-[1700px] mx-auto">
      
      <div class="mb-20 text-right">
        <div class="flex items-center justify-end gap-2 text-blue-400 font-mono font-bold uppercase tracking-[0.4em] text-[11px] mb-4 text-glow">
          <Activity size={14} class="animate-pulse" /> 
          <span>Visual_Link: Established</span>
        </div>
        <h1 class="text-white text-[clamp(3.5rem,10vw,7rem)] font-black uppercase italic tracking-tighter leading-none mb-6 drop-shadow-[0_0_30px_rgba(255,255,255,0.2)]">
          Captured <span class="text-blue-400 text-glow">Interests</span>
        </h1>
        <p class="text-white/40 font-mono uppercase tracking-[0.5em] text-[11px] mt-4 italic font-bold">
          Photography Log · High Definition Optics · Optimized for Web
        </p>
      </div>

      <div class="relative z-40 rounded-[2.5rem] bg-white/[0.05] backdrop-blur-[40px] border border-white/20 p-10 shadow-[0_0_50px_rgba(0,0,0,0.5)] transition-all duration-700 hover:border-blue-500/30">
        {/* Pass the dynamically fetched photos here */}
        <PhotoGallery client:load photos={photos} />

        {photos.length === 0 && (
          <div class="py-40 text-center bg-white/[0.02] border border-dashed border-white/20 rounded-[2rem]">
            <p class="text-white/40 font-mono uppercase tracking-widest text-sm italic">Transmission Received: No visual data found in S3_Sector.</p>
          </div>
        )}
      </div>

      <div class="mt-20 text-right group">
         <p class="text-white/50 font-mono text-[10px] uppercase tracking-[0.8em] transition-all duration-500 group-hover:text-white group-hover:tracking-[0.9em]">
           Captured by <span class="text-blue-400 font-black drop-shadow-[0_0_10px_rgba(96,165,250,0.8)]">ABHIRAM</span>
         </p>
      </div>
    </div>
  </main>
</Layout>