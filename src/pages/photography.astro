---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import PhotoGallery from '../components/PhotoGallery'; 
import EarthCanvas from '../components/EarthCanvas';
import { getCapturedInterests } from '../lib/aws';
import { Activity } from 'lucide-react';

// Fetch live from S3
const photos = await getCapturedInterests();

export const prerender = false;
---

<Layout title="Photography | Captured Interests">
  <div class="fixed inset-0 z-0 bg-[#000000] overflow-hidden">
    <div id="stars" class="absolute inset-0"></div>
    <div id="stars2" class="absolute inset-0"></div>
    <div id="stars3" class="absolute inset-0"></div>
    
    <div class="absolute inset-0 z-10 bg-[url('/noise.svg')] opacity-[0.03] mix-blend-overlay pointer-events-none"></div>
    <EarthCanvas client:only="react" />
    <div class="absolute inset-0 z-20 bg-gradient-to-b from-black/20 via-black/40 to-[#000000]"></div>
  </div>

  <Navbar />

  <main class="relative z-30 w-full min-h-screen pt-32 pb-40 px-[6vw] overflow-visible font-inter">
    <div class="max-w-[1700px] mx-auto">
      
      <div class="mb-20 text-right">
        <div class="flex items-center justify-end gap-2 text-blue-400 font-mono font-bold uppercase tracking-[0.4em] text-[11px] mb-4 text-glow">
          <Activity size={14} class="animate-pulse" /> 
          <span>Visual_Link: Established</span>
        </div>
        <h1 class="text-white text-[clamp(3.5rem,10vw,7rem)] font-black uppercase italic tracking-tighter leading-none mb-6 drop-shadow-[0_0_30px_rgba(255,255,255,0.2)]">
          Captured <span class="text-blue-400 text-glow">Interests</span>
        </h1>
        <p class="text-white/40 font-mono uppercase tracking-[0.5em] text-[11px] mt-4 italic font-bold">
          Photography Log Â· High Definition Optics Â· Optimized for Web
        </p>
      </div>

      <div class="relative z-40 rounded-[2.5rem] bg-white/[0.03] backdrop-blur-[40px] border border-white/10 p-10 shadow-[0_0_50px_rgba(0,0,0,0.5)] transition-all duration-700 hover:border-blue-500/30">
        <PhotoGallery client:load photos={photos} />

        {photos.length === 0 && (
          <div class="py-40 text-center bg-white/[0.02] border border-dashed border-white/10 rounded-[2rem]">
            <p class="text-white/40 font-mono uppercase tracking-widest text-sm italic">Transmission Received: No visual data found in S3_Sector.</p>
          </div>
        )}
      </div>

      <div class="mt-20 text-right group">
         <p class="text-white/50 font-mono text-[10px] uppercase tracking-[0.8em] transition-all duration-500 group-hover:text-white group-hover:tracking-[0.9em]">
           Captured by <span class="text-blue-400 font-black drop-shadow-[0_0_10px_rgba(96,165,250,0.8)]">ABHIRAM</span>
         </p>
      </div>
    </div>
  </main>
</Layout>

<style is:global>
  /* ðŸŒŒ Starfield Styles (Matches index, hosts, and leetcode) */
  #stars, #stars2, #stars3 { position: absolute; inset: 0; background: transparent; pointer-events: none; }
  #stars { width: 1px; height: 1px; box-shadow: 1452px 1451px #FFF, 246px 1452px #FFF, 1234px 12px #FFF, 456px 890px #FFF; animation: animStar 50s linear infinite; }
  #stars2 { width: 2px; height: 2px; box-shadow: 123px 456px #FFF, 789px 123px #FFF; animation: animStar 100s linear infinite; }
  #stars3 { width: 3px; height: 3px; box-shadow: 500px 500px #FFF, 1200px 800px #FFF; animation: animStar 150s linear infinite; }

  @keyframes animStar { from { transform: translateY(0px); } to { transform: translateY(-2000px); } }

  .text-glow {
    text-shadow: 0 0 20px rgba(96, 165, 250, 0.4);
  }
</style>